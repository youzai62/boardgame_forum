{"ast":null,"code":"var URL = require('url');\n\nfunction unless(middleware, options) {\n  if (typeof options === 'undefined') {\n    options = middleware;\n    middleware = this;\n  }\n\n  var opts = typeof options === 'function' ? {\n    custom: options\n  } : options;\n  opts.useOriginalUrl = typeof opts.useOriginalUrl === 'undefined' ? true : opts.useOriginalUrl;\n\n  const result = async function (req, res, next) {\n    var url = URL.parse((opts.useOriginalUrl ? req.originalUrl : req.url) || req.url || '', true);\n    var skip = false;\n\n    if (opts.custom) {\n      skip = skip || (await opts.custom(req));\n    }\n\n    var paths = oneOrMany(opts.path);\n\n    if (paths) {\n      skip = skip || paths.some(function (p) {\n        var methods = p.methods || oneOrMany(p.method);\n        return isUrlMatch(p, url.pathname) && isMethodMatch(methods, req.method);\n      });\n    }\n\n    var exts = !opts.ext || Array.isArray(opts.ext) ? opts.ext : [opts.ext];\n\n    if (exts) {\n      skip = skip || exts.some(function (ext) {\n        return url.pathname.substr(ext.length * -1) === ext;\n      });\n    }\n\n    var methods = oneOrMany(opts.method);\n\n    if (methods) {\n      skip = skip || methods.indexOf(req.method) > -1;\n    }\n\n    if (skip) {\n      return next();\n    }\n\n    middleware(req, res, next);\n  };\n\n  result.unless = unless;\n  return result;\n}\n\nfunction oneOrMany(elementOrArray) {\n  return !elementOrArray || Array.isArray(elementOrArray) ? elementOrArray : [elementOrArray];\n}\n\nfunction isUrlMatch(p, url) {\n  var ret = typeof p === 'string' && p === url || p instanceof RegExp && !!p.exec(url);\n\n  if (p instanceof RegExp) {\n    p.lastIndex = 0;\n  }\n\n  if (p && p.url) {\n    ret = isUrlMatch(p.url, url);\n  }\n\n  return ret;\n}\n\nfunction isMethodMatch(methods, m) {\n  if (!methods) {\n    return true;\n  }\n\n  methods = oneOrMany(methods);\n  return methods.indexOf(m) > -1;\n}\n\nmodule.exports = unless;","map":{"version":3,"sources":["C:/Users/zhuji/Desktop/heroku_sample/starter/Frontend/node_modules/express-unless/index.js"],"names":["URL","require","unless","middleware","options","opts","custom","useOriginalUrl","result","req","res","next","url","parse","originalUrl","skip","paths","oneOrMany","path","some","p","methods","method","isUrlMatch","pathname","isMethodMatch","exts","ext","Array","isArray","substr","length","indexOf","elementOrArray","ret","RegExp","exec","lastIndex","m","module","exports"],"mappings":"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","sourcesContent":["var URL = require('url');\n\nfunction unless(middleware, options) {\n  if (typeof options === 'undefined') {\n    options = middleware;\n    middleware = this;\n  }\n\n  var opts = typeof options === 'function' ? {custom: options} : options;\n  opts.useOriginalUrl = (typeof opts.useOriginalUrl === 'undefined') ? true : opts.useOriginalUrl;\n\n  const result = async function (req, res, next) {\n    var url = URL.parse((opts.useOriginalUrl ? req.originalUrl : req.url) || req.url || '', true);\n\n    var skip = false;\n\n    if (opts.custom) {\n      skip = skip || (await opts.custom(req));\n    }\n\n    var paths = oneOrMany(opts.path);\n\n    if (paths) {\n      skip = skip || paths.some(function (p) {\n        var methods = p.methods || oneOrMany(p.method);\n        return isUrlMatch(p, url.pathname) && isMethodMatch(methods, req.method);\n      });\n    }\n\n    var exts = (!opts.ext || Array.isArray(opts.ext)) ?\n               opts.ext : [opts.ext];\n\n    if (exts) {\n      skip = skip || exts.some(function (ext) {\n        return url.pathname.substr(ext.length * -1) === ext;\n      });\n    }\n\n    var methods = oneOrMany(opts.method);\n\n    if (methods) {\n      skip = skip || methods.indexOf(req.method) > -1;\n    }\n\n    if (skip) {\n      return next();\n    }\n\n    middleware(req, res, next);\n  };\n\n  result.unless = unless;\n\n  return result;\n}\n\nfunction oneOrMany(elementOrArray) {\n  return !elementOrArray || Array.isArray(elementOrArray) ?\n    elementOrArray : [elementOrArray];\n}\n\nfunction isUrlMatch(p, url) {\n  var ret = (typeof p === 'string' && p === url) || (p instanceof RegExp && !!p.exec(url));\n  if (p instanceof RegExp) {\n    p.lastIndex = 0;\n  }\n\n  if (p && p.url) {\n    ret = isUrlMatch(p.url, url);\n  }\n  return ret;\n}\n\nfunction isMethodMatch(methods, m) {\n  if (!methods) {\n    return true;\n  }\n\n  methods = oneOrMany(methods);\n\n  return methods.indexOf(m) > -1;\n}\n\nmodule.exports = unless;\n"]},"metadata":{},"sourceType":"script"}